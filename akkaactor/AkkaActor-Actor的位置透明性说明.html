<!DOCTYPE html><html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /><title>Actor的位置透明性说明 &mdash; 梦境迷离</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/vendor/primer-css/css/primer.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/css/components/collection.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/css/components/repo-card.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/css/sections/repo-list.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/css/components/boxed-group.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/css/globals/common.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/css/globals/responsive.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/css/posts/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/vendor/octicons/octicons/octicons.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mzlogin/rouge-themes@master/dist/github.css"><link rel="canonical" href="https://blog.dreamylost.cn/akkaactor/AkkaActor-Actor%E7%9A%84%E4%BD%8D%E7%BD%AE%E9%80%8F%E6%98%8E%E6%80%A7%E8%AF%B4%E6%98%8E.html"><link rel="alternate" type="application/atom+xml" title="梦境迷离" href="https://blog.dreamylost.cn/feed.xml"><link rel="shortcut icon" href="https://dreamylost.cn/favicon.ico"><meta property="og:title" content="Actor的位置透明性说明"><meta name="keywords" content="梦境迷离, jxnu-liguobin"><meta name="og:keywords" content="梦境迷离, jxnu-liguobin"><meta name="description" content=""><meta name="og:description" content=""><meta property="og:url" content="https://blog.dreamylost.cn/akkaactor/AkkaActor-Actor%E7%9A%84%E4%BD%8D%E7%BD%AE%E9%80%8F%E6%98%8E%E6%80%A7%E8%AF%B4%E6%98%8E.html"><meta property="og:site_name" content="梦境迷离"><meta property="og:type" content="article"><meta property="og:locale" content="zh_CN" /><meta property="article:published_time" content="2019-10-16"> <script src="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/vendor/jquery/dist/jquery.min.js"></script> <script src="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/js/jquery-ui.js"></script> <script src="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/js/main.js"></script> <script data-ad-client="ca-pub-8236444920328818" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body class="" data-mz=""><header class="site-header"><div class="container"><h1><a href="https://blog.dreamylost.cn/" title="梦境迷离"><span class="octicon octicon-mark-github"></span> 梦境迷离</a></h1><button class="collapsed mobile-visible" type="button" onclick="toggleMenu();"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button><nav class="site-header-nav" role="navigation"> <a href="https://blog.dreamylost.cn/" class=" site-header-nav-item" target="" title="首页">首页</a> <a href="https://blog.dreamylost.cn/categories/" class=" site-header-nav-item" target="" title="分类">分类</a> <a href="https://blog.dreamylost.cn/archives/" class=" site-header-nav-item" target="" title="归档">归档</a> <a href="https://blog.dreamylost.cn/open-source/" class=" site-header-nav-item" target="" title="开源">开源</a> <a href="https://blog.dreamylost.cn/wiki/" class=" site-header-nav-item" target="" title="维基">维基</a> <a href="https://blog.dreamylost.cn/links/" class=" site-header-nav-item" target="" title="链接">链接</a> <a href="https://blog.dreamylost.cn/about/" class=" site-header-nav-item" target="" title="关于">关于</a></nav></div></header><section class="collection-head small geopattern" data-pattern-id="Actor的位置透明性说明"><div class="container"><div class="columns"><div class="column three-fourths"><div class="collection-title"><h1 class="collection-header">Actor的位置透明性说明</h1><div class="collection-info"> <span class="meta-info"> <span class="octicon octicon-calendar"></span> 2019/10/16 </span> <span class="meta-info"> <span class="octicon octicon-file-directory"></span> <a href="https://blog.dreamylost.cn/categories/#AkkaActor" title="AkkaActor">AkkaActor</a> </span> <span class="meta-info"> <span class="octicon octicon-clock"></span> 共 1913 字，约 6 分钟 </span></div></div></div><div class="column one-fourth mobile-hidden"><div class="collection-title"> <img style="height:72px;width:72px" src="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/images/qrcode.jpg" alt="梦境迷离" /></div></div></div></div></section><section class="container content"><div class="columns"><div class="column three-fourths" ><article class="article-content markdown-body"><ul id="markdown-toc"><li><a href="#默认分布式" id="markdown-toc-默认分布式">默认分布式</a></li><li><a href="#破坏透明性的方式" id="markdown-toc-破坏透明性的方式">破坏透明性的方式</a></li><li><a href="#远程处理是如何使用的" id="markdown-toc-远程处理是如何使用的">远程处理是如何使用的</a></li><li><a href="#点对点客户端服务器" id="markdown-toc-点对点客户端服务器">点对点客户端服务器</a></li><li><a href="#用路由器放大的标记点" id="markdown-toc-用路由器放大的标记点">用路由器放大的标记点</a></li></ul><h3 id="默认分布式">默认分布式</h3><p>Akka中的所有内容都是在分布式环境中设计的：所有actor的交互都使用纯消息传递，而且一切都是异步的。 这项工作的目的是确保在单个JVM中或在数百台机器集群中运行时，所有功能都是同等可用的。 启用这一功能的关键是通过优化从远程到本地，而不是试图通过泛化从本地到远程。看见<a href="https://doc.akka.io/docs/misc/smli_tr-94-29.pdf">这篇经典论文</a>详细讨论第二种方法必然会失败的原因。 该论文当然也是英文的，确实需要深究的可以看看。</p><p>与Akka通过优化从远程到本地，与之相对的是传统的RPC框架则是通过透明化远程处理的方式实现（使远程调用看起来和本地调用相同。如：Java RMI）</p><p>这属于两种选择</p><ol><li>远程交互与本地交互采用相同的语义（理论上不可取，就是RMI这种，屏蔽了通信细节，调用者需要处理不确定的错误）</li><li>改变本地交互语义以适应远程通信的限制（过于激进，将本地与远程计算清楚的划分，并在代码中选择不同的表征）</li></ol><p>对于Akka而言，调用者实际就是消息发送者，它不需要处理调用异常。 位置透明性的目标并不在于使远程交互看起来像本地交互，更多的是在本地和远程交互的通用抽象下统一对消息传递的表达。</p><h3 id="破坏透明性的方式">破坏透明性的方式</h3><p>对于使用Akka的应用程序来说，什么是真的并不一定是正确的，因为为分布式执行的设计会对可能发生的事情造成一些限制。 最明显的一点是，通过（网络）连线发送的所有消息都必须是可序列化的。 虽然不那么明显，但这包括closures，如果要在远程节点上创建actor，这些closures被用作actor工厂（即在Props）。这里不太理解closures是闭包还是啥意思。 通过网络传输的消息必须是支持序列化的这点，我想会更重要一些。</p><p>另一个重要性的问题是，每件事都需要知道所有的交互都是完全异步的，这在计算机网络中可能意味着一条消息到达收件人可能需要几分钟（取决于配置）。 这还意味着消息丢失的概率要比在一个JVM中高得多，JVM几乎为零（仍然：没有硬保证！）。这点在(Actor消息传递的可靠性)那说明了。</p><h3 id="远程处理是如何使用的">远程处理是如何使用的</h3><p>我们认为透明性的概念是有限的，因为Akka的远程处理层几乎没有api：它完全是由配置驱动的。只需按照前面章节中概述的原则编写应用程序，然后在配置文件中指定actor子树的远程部署。 这样，您的应用程序就可以在不需要接触代码的情况下进行扩展。 API中唯一允许对远程部署产生编程影响的部分是，Props包含可以设置为特定Deploy实例的字段；这与将等效部署所需字段放入配置文件（如果两者都给定，配置文件优先）的效果相同。</p><p><a href="https://doc.akka.io/docs/akka/current/general/configuration.html">Akka 配置文件官方说明</a></p><h3 id="点对点客户端服务器">点对点客户端服务器</h3><p>Akka远程处理是一个以对等方式连接actor系统的通信模块，它是Akka集群的基础。远程处理的设计由两个（相关的）设计决策驱动：</p><ol><li>相关系统之间的通信是对称的：如果系统A可以连接到系统B，那么系统B也必须能够独立地连接到系统A。</li><li>就连接模式而言，通信系统的作用是对称的：没有只接受连接的系统，也没有只启动连接的系统。</li></ol><p>这些决定的结果是，不可能安全地创建具有预定义角色的纯客户端服务器设置（违反假设2）。对于客户端服务器设置，最好使用HTTP或Akka I/O。</p><p>重要：使用涉及网络地址转换、负载均衡或Docker容器的设置违反假设1，除非在网络配置中采取其他步骤以允许相关系统之间的对称通信。 在这种情况下，Akka可以被配置为绑定到不同于用于在Akka节点之间建立连接的网络地址。请看<a href="https://doc.akka.io/docs/akka/current/remoting.html#remote-configuration-nat">Akka behind NAT or in a Docker container.</a></p><h3 id="用路由器放大的标记点">用路由器放大的标记点</h3><p>除了能够在集群的不同节点上运行actor系统的不同部分之外，还可以通过增加支持并行化的actor子树（例如，一个并行处理不同查询的搜索引擎）来扩展到更多的核心。 然后，复制的actor（原文是clones，并且这里Points被我写成标记点了，这里更像是原actor的化身）可以以不同的方式被路由到，例如，round-robin。 实现这一目标的唯一必要之处是，开发人员需要将某个actor声明为“withRouter”，然后–取而代之–将创建一个路由器actor，它将以配置的方式生成一个可配置数量的、具有所需类型和路由的子节点。 一旦声明了这样的路由器，就可以从配置文件中自由地覆盖它的配置，包括将它与（一些）子程序的远程部署混合起来。在<a href="https://doc.akka.io/docs/akka/current/routing.html">路由</a>中阅读更多有关此信息的内容。</p><p><a href="https://doc.akka.io/docs/akka/current/general/remoting.html">文档</a></p><ul><li>使用搜狗翻译、百度翻译、谷歌翻译，仅供参考</li><li>来自官方文档、参考《响应式架构 消息模式Actor实现与Scala、Akka应用集成》</li><li>后续随着理解深入会继续修改错误和描述，以便更好理解，本博客开源，欢迎指出错误</li></ul><div style="margin-top:2em;padding:0 1.5em;border:1px solid #d3d3d3;background-color:#deebf7"><h3>文档信息</h3><ul><li>本文作者：<a href="https://blog.dreamylost.cn" target="_blank">梦境迷离</a></li><li>本文链接：<a href="https://blog.dreamylost.cn/akkaactor/AkkaActor-Actor%E7%9A%84%E4%BD%8D%E7%BD%AE%E9%80%8F%E6%98%8E%E6%80%A7%E8%AF%B4%E6%98%8E.html" target="_blank">https://blog.dreamylost.cn/akkaactor/AkkaActor-Actor%E7%9A%84%E4%BD%8D%E7%BD%AE%E9%80%8F%E6%98%8E%E6%80%A7%E8%AF%B4%E6%98%8E.html</a></li><li>版权声明：自由转载-非商用-非衍生-保持署名（<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank">创意共享3.0许可证</a>）</li></ul></div></article><div class="share"></div><div class="comment"><div id="gitalk-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/vendor/gitalk/gitalk.css"> <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script> <script> var gitalk = new Gitalk({ id: '/akkaactor/AkkaActor-Actor%E7%9A%84%E4%BD%8D%E7%BD', clientID: '061aadb5d449c0877d7d', clientSecret: '9aa7af7c248a7e36a07a86993e11a7acf7fbd353', repo: 'dreamylost-comments', owner: 'jxnu-liguobin', admin: ['jxnu-liguobin'], labels: ['gitment'], perPage: 50, }); gitalk.render('gitalk-container'); </script></div></div><div class="column one-fourth"><h3>Search</h3><div id="site_search"> <input style="width:96%" type="text" id="search_box" placeholder="Search"></div><ul id="search_results" style="font-size:14px;list-style-type:none;padding-top:10px;padding-left:10px;"></ul><script src="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/js/simple-jekyll-search.min.js"></script> <script type="text/javascript"> SimpleJekyllSearch({ searchInput: document.getElementById('search_box'), resultsContainer: document.getElementById('search_results'), json: 'https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@built/assets/search_data.json?v=1702960984', searchResultTemplate: '<li><a href="{url}" title="{title}">{title}</a></li>', noResultsText: 'No results found', limit: 10, fuzzy: false, exclude: ['Welcome'] }) </script><h3 class="post-directory-title mobile-hidden">Table of Contents</h3><div id="post-directory-module" class="mobile-hidden"><section class="post-directory"><dl></dl></section></div><script src="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/js/jquery.toc.js"></script></div></div></section><footer class="container"><div class="site-footer" role="contentinfo"><div class="copyright left mobile-block"> © 2019 <span title="梦境迷离">梦境迷离</span> <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a></div><ul class="site-footer-links right mobile-hidden"><li> <a href="javascript:window.scrollTo(0,0)" >TOP</a></li></ul><a href="https://github.com/jxnu-liguobin/jxnu-liguobin.github.io" target="_blank" aria-label="view source code"> <span class="mega-octicon octicon-mark-github" title="GitHub"></span> </a><ul class="site-footer-links mobile-hidden"><li> <a href="https://blog.dreamylost.cn/" title="首页" target="">首页</a></li><li> <a href="https://blog.dreamylost.cn/categories/" title="分类" target="">分类</a></li><li> <a href="https://blog.dreamylost.cn/archives/" title="归档" target="">归档</a></li><li> <a href="https://blog.dreamylost.cn/open-source/" title="开源" target="">开源</a></li><li> <a href="https://blog.dreamylost.cn/wiki/" title="维基" target="">维基</a></li><li> <a href="https://blog.dreamylost.cn/links/" title="链接" target="">链接</a></li><li> <a href="https://blog.dreamylost.cn/about/" title="关于" target="">关于</a></li><li><a href="https://blog.dreamylost.cn/feed.xml"><span class="octicon octicon-rss" style="color:orange;"></span></a></li></ul><script async src="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/vendor/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="mobile-hidden" style="margin-top:8px"> <span id="busuanzi_container_site_pv" style="display:none"> 本站访问量<span id="busuanzi_value_site_pv"></span>次 </span> <span id="busuanzi_container_site_uv" style="display:none"> / 本站访客数<span id="busuanzi_value_site_uv"></span>人 </span> <span id="busuanzi_container_page_pv" style="display:none"> / 本页访问量<span id="busuanzi_value_page_pv"></span>次 / 统计始于2019-09-20 </span></div></div></footer><div class="tools-wrapper"> <a class="gotop" href="#" title="回到顶部"><span class="octicon octicon-arrow-up"></span></a></div><script src="https://cdn.jsdelivr.net/gh/jxnu-liguobin/jxnu-liguobin.github.io@master/assets/js/geopattern.js"></script> <script> jQuery(document).ready(function($) { $('.geopattern').each(function(){ $(this).geopattern($(this).data('pattern-id')); }); /* hljs.initHighlightingOnLoad(); */ }); </script></body></html>
